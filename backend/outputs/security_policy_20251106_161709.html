<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Powered Security Policy Report</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 20px;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 40px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            font-weight: 700;
        }
        .header p {
            font-size: 1.1em;
            opacity: 0.95;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 40px;
            background: #f8f9fa;
        }
        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 5px solid;
        }
        .stat-card.sast { border-color: #667eea; }
        .stat-card.sca { border-color: #f093fb; }
        .stat-card.dast { border-color: #4facfe; }
        .stat-card h3 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .stat-card p {
            color: #666;
            font-size: 0.95em;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }
        .content {
            padding: 40px;
        }
        .llm-info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 40px;
        }
        .llm-info h2 {
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        .llm-info ul {
            list-style: none;
            padding-left: 0;
        }
        .llm-info li {
            padding: 8px 0;
            font-size: 1.05em;
        }
        .policy {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        .policy:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        .policy-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }
        .policy-number {
            font-size: 1.8em;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .policy-type {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .policy-type.sast {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .policy-type.sca {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        .policy-type.dast {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        .severity {
            display: inline-block;
            padding: 6px 16px;
            border-radius: 15px;
            font-weight: 600;
            font-size: 0.8em;
            margin-left: 10px;
        }
        .severity.CRITICAL { background: #dc3545; color: white; }
        .severity.HIGH { background: #fd7e14; color: white; }
        .severity.MEDIUM { background: #ffc107; color: #000; }
        .severity.LOW { background: #28a745; color: white; }
        .policy-title {
            font-size: 1.4em;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        .policy-content {
            line-height: 1.8;
            color: #555;
            white-space: pre-wrap;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        .llm-used {
            display: inline-block;
            background: #e7f3ff;
            color: #0066cc;
            padding: 6px 14px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin-top: 15px;
        }
        .footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 30px;
            font-size: 0.9em;
        }
        @media print {
            body { background: white; padding: 0; }
            .container { box-shadow: none; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ”’ AI-Powered Security Policy Report</h1>
            <p>Generated: November 06, 2025 at 16:17:09</p>
        </div>

        <div class="stats">
            <div class="stat-card sast">
                <h3>1</h3>
                <p>SAST Vulnerabilities</p>
            </div>
            <div class="stat-card sca">
                <h3>0</h3>
                <p>SCA Vulnerabilities</p>
            </div>
            <div class="stat-card dast">
                <h3>0</h3>
                <p>DAST Vulnerabilities</p>
            </div>
            <div class="stat-card">
                <h3>1</h3>
                <p>Total Policies</p>
            </div>
        </div>

        <div class="content">
            <div class="llm-info">
                <h2>ðŸ¤– LLM Models Used (Comparative Study)</h2>
                <ul>
                    <li>â€¢ <strong>LLaMA 3.3 70B (Groq)</strong> - Used for SAST/SCA (most capable)</li>
                    <li>â€¢ <strong>LLaMA 3.1 8B Instant (Groq)</strong> - Used for DAST (faster)</li>
                </ul>
            </div>

            <div class="policy">
                <div class="policy-header">
                    <div>
                        <span class="policy-number">Policy #1</span>
                        <span class="policy-type sast">SAST</span>
                        <span class="severity MEDIUM">MEDIUM</span>
                    </div>
                </div>
                <div class="policy-title">Var In Href</div>
                <div class="policy-content">**POLICY IDENTIFIER**
SP-2024-001: Cross-Site Scripting (XSS) Protection Policy

**RISK STATEMENT**
The organization is at risk of cross-site scripting (XSS) attacks due to the use of template variables in anchor tags with the 'href' attribute. This vulnerability allows malicious actors to input the 'javascript:' URI, potentially leading to unauthorized access, data theft, or system compromise. The affected systems include the NodeGoat application, and the impacted users are those accessing the profile.html page. If exploited, this vulnerability could result in significant business consequences, including reputational damage, financial loss, and compromised customer trust.

**COMPLIANCE MAPPING**
This policy aligns with the following compliance requirements:
- NIST CSF: PR.DS-5 (Data Protection), DE.CM-1 (Anomalous Activity Detection)
- ISO 27001: A.8.23 (Web filtering), A.8.8 (Management of technical vulnerabilities), A.8.7 (Protection against malware), A.8.16 (Monitoring activities)
- Industry standards: OWASP A7:2021 (Cross-Site Scripting), CWE-79 (Improper Neutralization of Input During Web Page Generation)

**POLICY REQUIREMENTS**
To mitigate the risk of XSS attacks, the following security controls must be implemented:
- Use of 'url_for()' or 'url' filter to safely generate URLs in the NodeGoat application
- Implementation of a Content Security Policy (CSP) header to define allowed sources of content
- Regular code reviews to ensure secure coding practices
- Success criteria: No detected XSS vulnerabilities in the NodeGoat application, validated through regular security scans and penetration testing

**REMEDIATION PLAN**
To remediate this vulnerability, the following technical actions are required:
- Review and fix the vulnerable code in the profile.html page (line 78)
- Responsible party: Dev Lead
- Timeline: 2 weeks
- Verification steps: Code review, re-scan using a vulnerability scanner, and penetration testing to ensure the fix is effective

**MONITORING AND DETECTION**
To detect similar vulnerabilities in the future, the organization will:
- Implement logging and alerting for suspicious activity, including anomalous URL requests
- Conduct regular security scans and penetration testing to identify potential vulnerabilities
- Continuously monitor the NodeGoat application for signs of XSS attacks, using tools such as web application firewalls (WAFs) and intrusion detection systems (IDS)
- Perform regular code reviews to ensure secure coding practices and adherence to this policy.</div>
                <div class="llm-used">ðŸ¤– Generated by: LLaMA 3.3 70B</div>
            </div>

        </div>

        <div class="footer">
            <p>Generated by AI-Powered Security Policy Generator</p>
            <p>Powered by LLaMA 3.3 70B & LLaMA 3.1 8B (Groq API)</p>
        </div>
    </div>
</body>
</html>
