<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Powered Security Policy Report</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px 20px;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 40px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            font-weight: 700;
        }
        .header p {
            font-size: 1.1em;
            opacity: 0.95;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 40px;
            background: #f8f9fa;
        }
        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border-left: 5px solid;
        }
        .stat-card.sast { border-color: #667eea; }
        .stat-card.sca { border-color: #f093fb; }
        .stat-card.dast { border-color: #4facfe; }
        .stat-card h3 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .stat-card p {
            color: #666;
            font-size: 0.95em;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }
        .content {
            padding: 40px;
        }
        .llm-info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 40px;
        }
        .llm-info h2 {
            margin-bottom: 15px;
            font-size: 1.5em;
        }
        .llm-info ul {
            list-style: none;
            padding-left: 0;
        }
        .llm-info li {
            padding: 8px 0;
            font-size: 1.05em;
        }
        .policy {
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        .policy:hover {
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        .policy-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }
        .policy-number {
            font-size: 1.8em;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .policy-type {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .policy-type.sast {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .policy-type.sca {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        .policy-type.dast {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        .severity {
            display: inline-block;
            padding: 6px 16px;
            border-radius: 15px;
            font-weight: 600;
            font-size: 0.8em;
            margin-left: 10px;
        }
        .severity.CRITICAL { background: #dc3545; color: white; }
        .severity.HIGH { background: #fd7e14; color: white; }
        .severity.MEDIUM { background: #ffc107; color: #000; }
        .severity.LOW { background: #28a745; color: white; }
        .policy-title {
            font-size: 1.4em;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        .policy-content {
            line-height: 1.8;
            color: #555;
            white-space: pre-wrap;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        .llm-used {
            display: inline-block;
            background: #e7f3ff;
            color: #0066cc;
            padding: 6px 14px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin-top: 15px;
        }
        .footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 30px;
            font-size: 0.9em;
        }
        @media print {
            body { background: white; padding: 0; }
            .container { box-shadow: none; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîí AI-Powered Security Policy Report</h1>
            <p>Generated: November 07, 2025 at 23:47:46</p>
        </div>

        <div class="stats">
            <div class="stat-card sast">
                <h3>10</h3>
                <p>SAST Vulnerabilities</p>
            </div>
            <div class="stat-card sca">
                <h3>0</h3>
                <p>SCA Vulnerabilities</p>
            </div>
            <div class="stat-card dast">
                <h3>0</h3>
                <p>DAST Vulnerabilities</p>
            </div>
            <div class="stat-card">
                <h3>1</h3>
                <p>Total Policies</p>
            </div>
        </div>

        <div class="content">
            <div class="llm-info">
                <h2>ü§ñ LLM Models Used (Comparative Study)</h2>
                <ul>
                    <li>‚Ä¢ <strong>LLaMA 3.3 70B (Groq)</strong> - Used for SAST/SCA (most capable)</li>
                    <li>‚Ä¢ <strong>LLaMA 3.1 8B Instant (Groq)</strong> - Used for DAST (faster)</li>
                </ul>
            </div>

            <!-- Quality Metrics Section -->
            <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 30px; border-radius: 15px; margin-bottom: 40px;">
                <h2 style="margin-bottom: 20px;">üìä Policy Quality Metrics</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px; text-align: center;">
                        <p style="font-size: 0.9em; opacity: 0.9; margin-bottom: 10px;">BLEU-4 Score</p>
                        <p style="font-size: 2em; font-weight: bold;">N/A</p>
                        <p style="font-size: 0.8em; opacity: 0.8; margin-top: 5px;">Text similarity metric</p>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px; text-align: center;">
                        <p style="font-size: 0.9em; opacity: 0.9; margin-bottom: 10px;">ROUGE-L Score</p>
                        <p style="font-size: 2em; font-weight: bold;">N/A</p>
                        <p style="font-size: 0.8em; opacity: 0.8; margin-top: 5px;">Content overlap metric</p>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px; text-align: center;">
                        <p style="font-size: 0.9em; opacity: 0.9; margin-bottom: 10px;">Overall Quality</p>
                        <p style="font-size: 2em; font-weight: bold;">Excellent</p>
                        <p style="font-size: 0.8em; opacity: 0.8; margin-top: 5px;">AI-generated policies</p>
                    </div>
                </div>
                <p style="margin-top: 20px; font-size: 0.9em; opacity: 0.9; text-align: center;">
                    üí° Tip: Upload your manual policy PDF in the SecurAI interface to compare metrics
                </p>
            </div>

            <!-- Compliance Coverage Section -->
            <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 15px; margin-bottom: 40px;">
                <h2 style="margin-bottom: 20px;">üõ°Ô∏è Compliance Framework Coverage</h2>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                    <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px;">
                        <h3 style="font-size: 1.2em; margin-bottom: 15px;">NIST CSF</h3>
                        <div style="background: rgba(255,255,255,0.3); border-radius: 5px; height: 10px; margin-bottom: 10px;">
                            <div style="background: #10b981; height: 100%; border-radius: 5px; width: 0%;"></div>
                        </div>
                        <p style="font-size: 0.9em;">Coverage will be calculated after policy generation</p>
                    </div>
                    <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px;">
                        <h3 style="font-size: 1.2em; margin-bottom: 15px;">ISO 27001</h3>
                        <div style="background: rgba(255,255,255,0.3); border-radius: 5px; height: 10px; margin-bottom: 10px;">
                            <div style="background: #10b981; height: 100%; border-radius: 5px; width: 0%;"></div>
                        </div>
                        <p style="font-size: 0.9em;">Coverage will be calculated after policy generation</p>
                    </div>
                </div>
                <p style="margin-top: 20px; font-size: 0.9em; opacity: 0.9; text-align: center;">
                    üìã View detailed compliance checklist in the SecurAI web interface
                </p>
            </div>

            <div class="policy">
                <div class="policy-header">
                    <div>
                        <span class="policy-number">Policy #1</span>
                        <span class="policy-type sast">SAST</span>
                        <span class="severity HIGH">HIGH</span>
                    </div>
                </div>
                <div class="policy-title">Explicit Unescape</div>
                <div class="policy-content">## üìö Understanding the Issue

### What is Explicit Unescape?
Explicit Unescape is a security vulnerability that happens when a web application doesn't properly handle user input. Imagine you're writing a letter to a friend, and you want to include a quote from someone else. You would put the quote in quotation marks to show it's not your words, right? In web development, there are similar ways to show that some text is special or should be treated differently. However, if an application doesn't properly "escape" or mark these special texts, it can lead to security issues. In this case, the vulnerability is in a Mustache template, which is a way to fill in templates with dynamic data.

### Why is it Dangerous?
Think of it like this: An attacker could send a malicious message that looks like a normal quote but actually contains harmful code. If the application doesn't properly escape this input, it could execute the harmful code, leading to a Cross-Site Scripting (XSS) attack. This is similar to someone sending you a letter with a hidden message that, when read aloud, gives them access to your house keys.

### Real-World Impact:
The real-world impact could be severe. An attacker could use this vulnerability to steal user data, take over user accounts, or even deface the website. It's like leaving your house unlocked; anyone can come in and do whatever they want.

## üíª How to Fix It

### Current Code (Vulnerable):
```javascript
// This line is vulnerable because it directly outputs user input without proper escaping
template = '&lt;div&gt;{{{ userInput }}}&lt;/div&gt;';
```
In this example, `userInput` is directly inserted into the HTML template without being escaped. This allows an attacker to inject malicious code.

### Fixed Code (Secure):
```javascript
// This line is secure because it properly escapes the user input
template = '&lt;div&gt;{{ userInput }}&lt;/div&gt;';
```
By using `{{ }}` instead of `{{{ }}}`, we ensure that the `userInput` is properly escaped, preventing any malicious code from being executed.

### Step-by-Step Fix:
1. **Identify Vulnerable Code**: Look through your codebase for any instances where user input is directly inserted into templates without proper escaping.
2. **Understand Mustache Syntax**: Learn about Mustache template syntax, especially the difference between `{{ }}` and `{{{ }}}`. The triple braces `{{{ }}}` are used for unescaped HTML, which can be dangerous if used with user input.
3. **Replace Vulnerable Code**: Replace any instances of `{{{ }}}` with `{{ }}` when dealing with user input. This will ensure that the input is properly escaped and cannot be used for XSS attacks.
4. **Test for XSS**: After fixing the code, test it to ensure that XSS attacks are no longer possible. You can do this by trying to inject malicious scripts and verifying that they do not execute.

## ‚úÖ Testing Your Fix

### How to Verify:
1. **Inject Malicious Script**: Try to inject a simple script tag into the user input field. For example, you could try entering `&lt;script&gt;alert('XSS')&lt;/script&gt;`.
2. **Verify No Execution**: If your fix is correct, the script should not execute. Instead, you should see the script tags as plain text on the page, indicating that they were properly escaped.

### Test Cases:
```javascript
// Example test case in JavaScript
const userInput = '&lt;script&gt;alert("XSS")&lt;/script&gt;';
const template = '&lt;div&gt;{{ userInput }}&lt;/div&gt;';
// Render the template with the user input
const renderedTemplate = Mustache.render(template, { userInput });
console.log(renderedTemplate);
// The output should be plain text, not executing the script
```

## üéì Learn More

- OWASP Guide: [OWASP Cross-Site Scripting (XSS)](https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS))
- Tutorial: [Mustache Template Syntax](https://mustache.github.io/mustache.5.html)
- Best Practices: [OWASP Secure Coding Practices](https://owasp.org/www-project-secure-coding-practices/)

## üìã Compliance

This fix helps meet:
- NIST CSF: ID.AM (Asset Management), PR.DS (Data Security)
- ISO 27001: A.8.23 (Web filtering), A.8.8 (Management of technical vulnerabilities), A.8.28 (Secure coding)

## ‚è∞ Timeline

Priority: HIGH
Estimated Time: 2 hours
Deadline: 1 day

Remember: Security is a learning process. Don't hesitate to ask for help! If you're unsure about any part of this process, consult with a security expert or a senior developer.</div>
                <div class="llm-used">ü§ñ Generated by: LLaMA 3.3 70B</div>
            </div>

        </div>

        <div class="footer">
            <p>Generated by AI-Powered Security Policy Generator</p>
            <p>Powered by LLaMA 3.3 70B & LLaMA 3.1 8B (Groq API)</p>
        </div>
    </div>
</body>
</html>
